require 'cli/table_output_helper'

module Web
  module Helpers
    # A helper class for handling event emitters when running from the web UI.
    class WebSessionOutputHelper
      include Cli::TableOutputHelper

      def initialize(session)
        super()
        self.session = session
        self.indent = ''
      end

      def on_event_emitted(event)
        session.events.create(
          message: event[:msg] || "\n" + build_table(event[:rows]),
          level: event[:type],
          verbose: event[:verbose]
        )
      end

      attr_accessor :session
    end
  end
end
